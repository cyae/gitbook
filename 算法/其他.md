---
date created: 2023-03-08 18:12
---

## Manacher

```java
public String longestPalindrome(String str) {
	char[] s = process(str);
	int len = s.length;
	int R = -1; // 全局最右回文下标
	int C = -1; // 全局回文中心
	int max = -1;
	int[] maxPalinR = new int[len]; // 每个位置的最大回文半径

	for (int i = 0; i < len; ++i) {

		maxPalinR[i] = i < R ? Math.min(R - i, maxPalinR[2 * C - i]) : 1;

		while (i + maxPalinR[i] < len && i - maxPalinR[i] >= 0) {
			if (s[i + maxPalinR[i]] == s[i - maxPalinR[i]]) {
				maxPalinR[i]++;
			} else break;
		}

		if (i + maxPalinR[i] > R) {
			R = i + maxPalinR[i];
			C = i;
		}

		max = Math.max(max, maxPalinR[i]);
	}

	return max - 1;
}
```
